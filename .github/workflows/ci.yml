name: CI Infrastructure

on:
  push:
    paths:
      - "ansible/**"
      - "terraform/**"
      - "la_manu_front/**"
  pull_request:

jobs:
  ci-checks:
    name: VÃ©rifications CI
    runs-on: ubuntu-latest

    steps:
      - name: ğŸ”„ Checkout
        uses: actions/checkout@v3

      - name: ğŸ›  Installer outils
        run: |
          sudo apt update
          sudo apt install -y ansible terraform npm docker.io
          sudo systemctl start docker

      - name: âœ… Ansible Syntax Check
        run: ansible-playbook ansible/site.yml --syntax-check

      - name: ğŸ” Terraform Validation
        run: |
          terraform -chdir=terraform init -input=false
          terraform -chdir=terraform validate

      - name: ğŸ§ª Tests Jest
        run: |
          cd la_manu_front
          npm install
          npm run test --